@page
@model FarmClients.Pages.Admin.ProduveModel
@{
	Layout = "~/Pages/Admin/Shared/_AdminLayout.cshtml";
}


<html lang="en">
<body>
			<div class="main-content">
				<div class="row">
					<div class="col-md-12">
						<div class="table-wrapper">

							<div class="table-title">
								<div class="row">
									<div class="col-sm-6 p-0 flex justify-content-lg-start justify-content-center">
										<h2 class="ml-lg-2">Manage  Produce</h2>
									</div>
									<div class="col-sm-6 p-0 flex justify-content-lg-end justify-content-center">
								<a href="#addProduceModal" class="btn btn-success" data-toggle="modal">
											<i class="material-icons">&#xE147;</i>
									<span>Add New Produce</span>
										</a>
										<a href="#deleteEmployeeModal" class="btn btn-danger" data-toggle="modal">
											<i class="material-icons">&#xE15C;</i>
											<span>Delete</span>
										</a>
									</div>
								</div>
							</div>

					<table id="employeeTable" class="table table-striped table-hover">
						<!-- Đầu bảng -->
						<thead>
							<tr>
								<!-- Các cột -->
								<th>Id</th>
								<th>Name</th>
								<th>Description</th>
								<th>PlantingDate</th>
								<th>ExpectedHarvestDate</th>
								<th>ActualHarvestDate</th>
								<th>Quantity</th>
								<th>Status</th>
								<th>Action</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>

					<style>
						.status-yellow {
							background-color: yellow;
							color: black;
						}

						.status-green {
							background-color: green;
							color: white;
						}

						.status-blue {
							background-color: blue;
							color: white;
						}

						.status-red {
							background-color: red;
							color: white;
						}
					</style>


					<script>
						fetch('https://localhost:7020/api/Produce')
							.then(response => response.json()) // Chuyển đổi phản hồi sang JSON
							.then(data => {
								// Lặp qua từng dòng dữ liệu và thêm vào bảng
								data.forEach(produce => {
									const row = `
										<tr>
											<td>${produce.produceId}</td>
											<td>${produce.name}</td>
											<td>${produce.description}</td>
											<td>${formatDate(produce.plantingDate)}</td>
											<td>${formatDate(produce.expectedHarvestDate)}</td>
											<td>${formatDate(produce.actualHarvestDate)}</td>
											<td>${produce.quantity}</td>
											<td>${getStatusText(produce.status)}</td>

											<td>
												<a href="#viewEmployeeDetailsModal" class="view-details" data-toggle="modal">
													<i class="material-icons" data-toggle="tooltip" title="View Details">visibility</i>
												</a>

												<a href="#editEmployeeModal" class="edit" data-toggle="modal">
													<i class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</i>
												</a>

												<a href="#deleteEmployeeModal" class="delete" data-toggle="modal">
													<i class="material-icons" data-toggle="tooltip" title="Delete">&#xE872;</i>
												</a>
											</td>
										</tr>`;
									document.querySelector('#employeeTable tbody').insertAdjacentHTML('beforeend', row);
								});
							})
							.catch(error => console.error('There was a problem with the fetch operation:', error));

						function formatDate(dateString) {
							const date = new Date(dateString);
							const year = date.getFullYear();
							let month = (date.getMonth() + 1).toString().padStart(2, '0');
							let day = date.getDate().toString().padStart(2, '0');
							return `${year}-${month}-${day}`;
						}

						function getStatusText(status) {
							switch (status) {
								case 1:
									return "<span class='status-yellow'>Taking care</span>";
								case 2:
									return "<span class='status-green'>Harvest</span>";
								case 3:
									return "<span class='status-blue'>Preserve</span>";
								case 4:
									return "<span class='status-red'>Expired</span>";
								default:
									return "Unknown";
							}
						}

					

					</script>


					<!----add-modal start--------->
					<div class="modal fade" tabindex="-1" id="addProduceModal" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Add Produce</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<div class="form-group">
										<label>Name</label>
										<input type="text" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Description</label>
										<input type="text" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Planting Date</label>
										<input type="date" class="form-control" required>
									</div>
									<div class="form-group">
										<label>ExpectedHarvest Date</label>
										<input type="date" class="form-control" required>
									</div>
									<div class="form-group">
										<label>ActualHarvest Date</label>
										<input type="date" class="form-control">
									</div>
									<div class="form-group">
										<label>GardenID</label>
										<input type="number" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Quantity</label>
										<input type="number" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Img</label>
										<input type="text" class="form-control">
									</div>
									<div class="form-group">
										<label>Price</label>
										<input type="number" class="form-control" >
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-success">Add</button>
								</div>
							</div>
						</div>
					</div>

					<!----edit-modal end--------->
					<!----edit-modal start--------->
					<div class="modal fade" tabindex="-1" id="editEmployeeModal" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Edit Employees</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<div class="form-group">
										<label>Name</label>
										<input type="text" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Description</label>
										<input type="text" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Planting Date</label>
										<input type="date" class="form-control" required>
									</div>
									<div class="form-group">
										<label>ExpectedHarvest Date</label>
										<input type="date" class="form-control" required>
									</div>
									<div class="form-group">
										<label>ActualHarvestDate</label>
										<input type="date" class="form-control" >
									</div>
									<div class="form-group">
										<label>GardenID</label>
										<input type="number" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Quantity</label>
										<input type="number" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Status</label>
										<input type="number" class="form-control" required>
									</div>
									<div class="form-group">
										<label>Img</label>
										<input type="text" class="form-control">
									</div>
									<div class="form-group">
										<label>Price</label>
										<input type="number" class="form-control">
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-success">Add</button>
								</div>
							</div>
						</div>
					</div>

					<!----edit-modal end--------->
					<!----delete-modal start--------->
					<div class="modal fade" tabindex="-1" id="deleteEmployeeModal" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Delete Employees</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<p>Are you sure you want to delete this Records</p>
									<p class="text-warning"><small>this action Cannot be Undone,</small></p>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-success">Delete</button>
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>

	<script src="~/jsAD/jquery-3.3.1.slim.min.js"></script>
	<script src="~/jsAD/popper.min.js"></script>
	<script src="~/jsAD/bootstrap.min.js"></script>
	<script src="~/jsAD/jquery-3.3.1.min.js"></script>


	<script type="text/javascript">
		$(document).ready(function () {
			$(".xp-menubar").on('click', function () {
				$("#sidebar").toggleClass('active');
				$("#content").toggleClass('active');
			});

			$('.xp-menubar,.body-overlay').on('click', function () {
				$("#sidebar,.body-overlay").toggleClass('show-nav');
			});

		});
	</script>

</body>
</html>